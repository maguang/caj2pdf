# CAJ to PDF
#中国知网CAJ/KDH/NH批量转PDF的技术方案

中国知网有CAJ/KDH/NH三种特殊格式，只能使用官方的阅读器阅读，兼容性较差。网上现有各种方案，或有几个弊端：1）不能完全转换；2）转换后体积膨胀太大；3）无法保留原始的文本层；4）无法批量处理。

经过尝试，终于摸索到了批量将中国知网CAJ/KDH/NH三种特殊格式转成PDF的较好方式：

第一步：python脚本（附件1：01提取caj .py），批量自动遍历识别并移动CAJ/KDH/NH文件到A文件夹，并将文件的原始位置保存到json文件。

第二步：打开官方的全球学术快报软件，从A文件夹批量导入，导出为PDF格式。

第三步：python脚本（附件2：02回迁pdf.py），读取保存的json文件，将PDF移动到对应的CAJ原位置。成功后，删除CAJ即可。

这种方案的优点：

1）官方工具，基本上可以全部成功转换CAJ。

2）体积最小，避免体积膨胀，且可以保留原文件中的文本层。

3）速度快，且不易出错。

4）代码简单，避免调用旧版caj2pdf的复杂且常出错的过程。

5）适用于多种操作系统。

以上方案，完全可以避免cajviewer、caj2pdf-qt等软件的弊端。个人认为，这可能目前最佳的解决方案。当然，您若有更好的方案，还请赐教！





